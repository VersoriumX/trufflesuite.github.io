<!DOCTYPE html>
<html>
<head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WHT4PS2');</script>
  <!-- End Google Tag Manager -->
  
  <!-- HubSpot Forms -->
  <!--[if lte IE 8]>
    <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
  <![endif]-->
  <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>  <!-- Start of HubSpot Embed Code -->
  <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/4795067.js"></script>
  <!-- End of HubSpot Embed Code -->  
  <meta charset="utf-8">
  <meta name="description" content="The Truffle suite of tools make dapp development easier and more consistent.">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  
  <!-- Favicon -->
  <link rel="icon" href="/img/favicons/favicon.ico">

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Truffle Suite">
  <link rel="icon" sizes="192x192" href="/img/favicons/chrome-touch-icon-192x192.png">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Truffle Suite">
  <link rel="apple-touch-icon" href="/img/favicons/apple-touch-icon.png">

  <!-- Tile icon for Win8/10 (144x144 + tile color) -->
  <meta name="msapplication-TileImage" content="img/favicons/ms-touch-icon-144x144-precomposed.png">
  <meta name="msapplication-TileColor" content="#3372DF">

  <!-- Facebook OpenGraph -->
  <meta property="og:site_name" content="Truffle Suite" />
  <meta property="og:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta property="og:title" content="Using Infura (or a custom provider) | Tutorials | Truffle Suite" />
  <meta property="og:url" content="https://trufflesuite.com/guides/using-infura-custom-provider" />
  <meta property="og:type" content="article" />
  <meta property="og:image" content="https://truffleframework.com/img/favicons/truffle-share.png" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="Truffle Suite" />
  <meta name="twitter:title" content="Using Infura (or a custom provider) | Tutorials | Truffle Suite" />
  <meta name="twitter:description" content="The Truffle suite of tools make dapp development easier and more consistent." />
  <meta name="twitter:creator" content="Truffle Suite" />
  <meta name="twitter:domain" content="trufflesuite.com" />
  <meta name="twitter:image:src" content="https://truffleframework.com/img/favicons/truffle-share.png" />
  
  <meta name="google-site-verification" content="BSgPkMHzw7IxJTpEElNfD8ZZYPzXgOQiTVPzAxAG8-o" />
    
  <title>Using Infura (or a custom provider) | Guides | Truffle Suite</title>

  <link href="https://fonts.googleapis.com/css?family=Grand+Hotel|Open+Sans|Oswald|Varela+Round|Roboto+Condensed|Roboto+Mono" rel="stylesheet">
  <script src="https://kit.fontawesome.com/371f2d7a8a.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/css/index.css">
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WHT4PS2"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->  
    <nav class="navbar navbar-expand-md navbar-dark fixed-top" id="primaryNav">
    <a class="navbar-brand current" href="/">
        <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span class="d-none d-lg-block">TRUFFLE SUITE</span>
    </a>
  
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" id="suiteDropdown" href="#" data-toggle="dropdown">SUITE</a>
  
          <div class="dropdown-menu">
            <a class="text-truffle" href="/teams">
              <img class="suite-logo" src="/img/tt-logomark.svg" alt="Truffle Teams Logo" /><span class="narrow">T</span>RUFFLE TEAMS
            </a>
            <a class="text-truffle" href="/truffle">
              <img class="suite-logo" src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span class="narrow">T</span>RUFFLE
            </a>
            <a class="text-ganache" href="/ganache">
              <img class="suite-logo" src="/img/ganache-logomark.svg" alt="Ganache Logo" />Ganache
            </a>
            <a class="text-drizzle" href="/drizzle">
              <img class="suite-logo" src="/img/drizzle-logomark.svg" alt="Drizzle Logo" />dri<span class="drizzle-z-skew-1">z</span><span class="drizzle-z-skew-2">z</span>le
            </a>
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/docs">DOCS</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/guides">GUIDES</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/tutorial">TUTORIAL</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/boxes">BOXES</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/blog">BLOG</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/community">COMMUNITY</a>
        </li>
      </ul>
    </div>
  </nav>

  <main class="container container-heading container-narrow">
    <div class="row">
      <div class="col">
        <h1>Using Infura (or a custom provider)</h1>
        <ul class="list-sm-stacker space-icon mb-0">
          <li><i class="far fa-calendar-alt"></i> 2016-09-16&nbsp;(updated 2021-01-14)&nbsp;&nbsp;</li>
          <li><i class="far fa-user"></i> Tim Coulter</li>
        </ul>
      </div>
    </div>
  </main>

  <main class="banner banner-light-cream pt-5 pb-5" role="main">
    <div class="container container-post">
      <div class="row justify-content-center">
        <div class="col">
          <p>
    <img class="img-fluid" src="/img/tutorials/infura/infura-truffle.png" title="Infura Truffle logos" alt="Infura Truffle logos" />
    
  </p>
<p><a href="https://infura.io/?&amp;utm_source=truffle&amp;utm_medium=referral&amp;utm_campaign=tutorials&amp;utm_content=truffleinfuraguide">Infuraâ€™s API suite</a> provides instant HTTPS and WebSocket access to the Ethereum and IPFS networks. By using Infura, you can connect easily to Web 3.0 without having to spin-up and maintain your own infrastructure. Their <a href="https://infura.io/pricing?&amp;utm_source=truffle&amp;utm_medium=referral&amp;utm_campaign=tutorials&amp;utm_content=truffleinfuraguide">core service is free</a> and provides everything you need to start building awesome decentralized applications today!</p>
<p>You may not be familiar with Infura by name, but if you&#39;ve used <a href="https://metamask.io">MetaMask</a> then you&#39;ve used Infura, as it is the Ethereum provider that powers MetaMask.</p>
<p>For security reasons, Infura does not manage your private keys, which means Infura cannot sign transactions on your behalf.</p>
<p>However, Truffle can sign transactions through the use of its <code>HDWalletProvider</code>. This provider can handle the transaction signing as well as the connection to the Ethereum network. (<a href="https://github.com/trufflesuite/truffle/tree/develop/packages/hdwallet-provider">Read more about HDWalletProvider</a>.)</p>
<p>This tutorial will show you how to use Infura to migrate an existing dapp to an Ethereum network supported by Infura. In this specific instance, we&#39;ll migrate to Ropsten. We&#39;ll assume that you already have a dapp to migrate. If you want a test dapp, feel free to use our <a href="/tutorials/pet-shop">Pet Shop</a> tutorial dapp.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="install-hdwalletprovider"></a>
      <a href="#install-hdwalletprovider"><i class="fas fa-link"></i></a>
      Install HDWalletProvider
    </h2>
  <p>Truffle&#39;s <code>HDWalletProvider</code> is a separate npm package:</p>
<pre><code class="language-shell">npm install @truffle/hdwallet-provider</code></pre>
<p class="alert alert-info">
<strong>Note</strong>: If you are on Windows and get an `MSBUILD` error, you may need to install the Windows build tools. In a terminal with Administrator rights, run `npm install -g windows-build-tools` and then try installation again.
</p>


    <h2 class="link-markdown">
      <a class="anchor-target" name="register-with-infura-and-create-a-new-project"></a>
      <a href="#register-with-infura-and-create-a-new-project"><i class="fas fa-link"></i></a>
      Register with Infura and create a new project
    </h2>
  <p>Before you can use Infura, you need to <a href="https://infura.io/signup?&amp;utm_source=truffle&amp;utm_medium=referral&amp;utm_campaign=tutorials&amp;utm_content=truffleinfuraguide">register</a>. Upon registration, <a href="https://blog.infura.io/getting-started-with-infura-28e41844cc89/?&amp;utm_source=truffle&amp;utm_medium=referral&amp;utm_campaign=tutorials&amp;utm_content=truffleinfuraguide">this guide</a> will walk you through creating a new project, authenticating with your new Project ID and Secret, securely copying your keys and selecting the appropriate network endpoint.</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="configure-your-truffle-project"></a>
      <a href="#configure-your-truffle-project"><i class="fas fa-link"></i></a>
      Configure your Truffle project
    </h2>
  <p>The next step is to edit your <code>truffle-config.js</code> file to use <code>HDWalletProvider</code> and provide all the necessary configuration for deploying to Ropsten.</p>
<ol>
<li><p>First, define the <code>HDWalletProvider</code> object in your configuration file. Add this line at the top of your <code>truffle-config.js</code> file:</p>
<pre><code class="language-javascript">const HDWalletProvider = require(&quot;@truffle/hdwallet-provider&quot;);</code></pre>
</li>
<li><p>Next, provide a reference to your mnemonic that generates your accounts. If you don&#39;t have a mnemonic, you can generate one using an <a href="https://iancoleman.io/bip39">online mnemonic generator</a> or a hardware wallet such as a product from <a href="https://www.ledger.com">Ledger</a>.</p>
<pre><code class="language-javascript">const mnemonic = &quot;orange apple banana ... &quot;;</code></pre>
<p class="alert alert-danger">
<strong>Warning</strong>: In production, we highly recommend storing the mnemonic in another (secret) file, to reduce the risk of the mnemonic becoming known. If someone knows your mnemonic, they have all of your addresses and private keys!
</p>
</li>
<li><p>Add a Ropsten network definition:</p>
<pre><code class="language-javascript">module.exports = {
  networks: {
    ropsten: {
      provider: function() {
        return new HDWalletProvider(mnemonic, &quot;https://ropsten.infura.io/v3/&lt;INFURA_PROJECT_ID&gt;&quot;)
      },
      network_id: 3
    }
  }
};</code></pre>
<p>Things to notice:</p>
<ul>
<li><p>While the example has only a single network defined, you can define multiple networks as normal.</p>
</li>
<li><p>The <code>provider</code> for the <code>ropsten</code> network definition instantiates the <code>HDWalletProvider</code>.</p>
</li>
<li><p>The <code>HDWalletProvider</code> takes as arguments a mnemonic and the desired network. A list of Infura-supported networks is available in the Endpoints dropdown on your Infura Project Settings page.</p>
</li>
</ul>
</li>
</ol>
<figure class="screenshot">
  <img class="figure-shadow mb-2 w-100" src="/img/tutorials/infura/infura-project-details.png" alt="Infura Project Details">
</figure>

<ul>
<li><p>Make sure to replace <code>&lt;INFURA_PROJECT_ID&gt;</code> with your Infura Project ID.</p>
</li>
<li><p>The <code>provider</code> value is wrapped in a function, which ensures that it won&#39;t get initialized until it&#39;s needed. This is especially important if connecting to multiple networks. (See the <a href="http://trufflesuite.com/docs/advanced/configuration#networks">Networks configuration</a> section of the documentation for more on this topic.)</p>
<p class="alert alert-info">
  <strong>Note</strong>: If you encounter issues with this construction, you can skip the function wrapper and use this instead:<br />
  `provider: new HDWalletProvider(mnemonic, "https://ropsten.infura.io/v3/<INFURA_PROJECT_ID>"),`
</p>
</li>
<li><p>Without any other arguments, the account in charge of migration will be the first one generated by the mnemonic. But if desired, you can pass in an argument to specify which account to use. As an example, to use the third account:</p>
<pre><code class="language-javascript">new HDWalletProvider(mnemonic, &quot;https://ropsten.infura.io/v3/&lt;INFURA_PROJECT_ID&gt;&quot;, 2);</code></pre>
<p>(Recall that the index is zero-based, so <code>2</code> is the third address.)</p>
</li>
</ul>

    <h2 class="link-markdown">
      <a class="anchor-target" name="use-an-ether-faucet"></a>
      <a href="#use-an-ether-faucet"><i class="fas fa-link"></i></a>
      Use an ether faucet
    </h2>
  <p>Make sure you have enough ether in your account to do the deployment. You can acquire ether on the Ropsten network through a service known as a faucet. While there are multiple faucet sites out there, one service we recommend is hosted by <a href="https://metamask.io/">MetaMask</a>.</p>
<ol>
<li><p>Navigate to <a href="https://faucet.metamask.io/">MetaMask&#39;s Test Ether Faucet</a>.</p>
</li>
<li><p>Connect to the Ropsten Test Network using <a href="https://metamask.io/">MetaMask</a>.</p>
</li>
<li><p>The faucet will link to your first account. Click &quot;Request 1 Ether From Faucet&quot; to submit your request.</p>
</li>
<li><p>Within a short period of time, your account will be populated with the requested ether.</p>
</li>
</ol>
<p>We are now ready to deploy to Ropsten!</p>

    <h2 class="link-markdown">
      <a class="anchor-target" name="deploy-the-contract"></a>
      <a href="#deploy-the-contract"><i class="fas fa-link"></i></a>
      Deploy the contract
    </h2>
  <ol>
<li><p>Compile your project, if not already done:</p>
<pre><code class="language-shell">truffle compile</code></pre>
</li>
<li><p>Deploy to the Ropsten network:</p>
<pre><code class="language-shell">truffle migrate --network ropsten</code></pre>
<p>If all goes well, you should see a response that looks similar to the following:</p>
</li>
</ol>
<pre><code>Starting migrations...
======================
&gt; Network name:    &#39;ropsten&#39;
&gt; Network id:      3
&gt; Block gas limit: 0x6691b7


1_initial_migration.js
======================

   Deploying &#39;Migrations&#39;
   ----------------------
   &gt; transaction hash:    0x166c1791caa73cca6a75fe4258866bd1f2d1bcf2cd4c3a2a1e03fab29c42829d
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0x5ccb4dc04600cffA8a67197d5b644ae71856aEE4
   ......
   ......</code></pre><p>Note that your transaction hash and contract address will be different from the ones above.</p>
<p class="alert alert-info">
   <strong>Note</strong>: If you receive an error `Error: Exceeds block gas limit
   `, you may need to manually set the gas limit for your contract. See the [Truffle Configuration](/docs/advanced/configuration) documentation for details.
</p>

<p>If you want to verify that your contract was deployed successfully, you can check this on the <a href="https://ropsten.etherscan.io/">Ropsten section of Etherscan</a>. In the search field, type in the transaction ID for your contract. In the above example, the transaction ID is:</p>
<pre><code>0x166c1791caa73cca6a75fe4258866bd1f2d1bcf2cd4c3a2a1e03fab29c42829d</code></pre><p>You should see details about the transaction, including the block number where the transaction was secured.</p>
<p>Congratulations! You&#39;ve deployed your contract to Ropsten using the combined power of Infura and Truffle.</p>


          <div class="contribute-link">
            See a way to make this page better? <a href="https://github.com/trufflesuite/trufflesuite.com/edit/develop/src/guides">Edit here &raquo;</a>
          </div>        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-2 mb-4 mb-md-0">
          <img class="truffle-logo" src="/img/truffle-logo-light.svg" alt="Truffle Logo" />
        </div>
  
        <div class="col-12 col-md-5 mb-3 mb-md-0">
          <ul>
            <li><a href="mailto:inquiry@trufflesuite.com">CONTACT US</a></li>
            <li><a href="/policy">PRIVACY POLICY</a></li>
            <li><a href="/press-releases">PRESS RELEASES</a></li>
            <li><a href="/staff">STAFF</a></li>
            <li><a href="/dashboard">DASHBOARD</a></li>
            <li><a href="https://github.com/trufflesuite">GITHUB</a></li>
            <li><a class="trufflecon-link" href="https://www.trufflesuite.com/trufflecon2020">TRUFFLEC<img src="/img/truffle-logomark.svg" alt="Truffle Logo" /><span>O</span>N 2020</a></li>
            <li><strong>&copy; ConsenSys Software Inc. 2021</strong></li>
          </ul>
  
          <ul class="list-inline h4 ">
            <li class="list-inline-item mb-0"><a href="https://www.reddit.com/r/truffle"><i class="fab fa-reddit-square"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://twitter.com/trufflesuite"><i class="fab fa-twitter-square"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.facebook.com/trufflesuite/"><i class="fab fa-facebook-square"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.instagram.com/truffledevsuite/"><i class="fab fa-instagram"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.linkedin.com/company/trufflesuite/"><i class="fab fa-linkedin"></i></a></li>
            <li class="list-inline-item mb-0"><a href="https://www.youtube.com/channel/UCo2cy2Z7_91zPJSrb6NWfSw"><i class="fab fa-youtube-square"></i></a></li>
          </ul>
        </div>
  
        <div class="col-12 col-md-5">
          <h4>SIGN UP FOR THE TRUFFLE MAILING LIST</h4>
          <!--[if lte IE 8]>
            <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2-legacy.js"></script>
          <![endif]-->
          <script charset="utf-8" type="text/javascript" src="//js.hsforms.net/forms/v2.js"></script>
          <script>
            hbspt.forms.create({
              portalId: "4795067",
              formId: "d18995c8-32bb-4b2d-bde9-3f49fb3d2837"
            });
          </script>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script>window.jQuery || document.write('<script src="/js/vendor/jquery-3.2.1.slim.min.js"><\/script>')</script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/vendor/prism.js"></script>
  <script src="/js/markdown-cleanup.js"></script>
</body>
</html>